name: Validate PR Title

on:
  pull_request_target:
    branches: [main]
    types: [opened, edited, synchronize, reopened]

jobs:
  validate-pr-title:
    runs-on: ubuntu-latest
    steps:
      - uses: amannn/action-semantic-pull-request@v6.1.1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          # Types aligned with this repo's commit conventions (see AGENTS.md)
          types: |
            feat
            fix
            docs
            style
            refactor
            perf
            test
            build
            ci
            chore
            revert
          requireScope: false
          # Repo convention: lowercase subjects (e.g., "feat: add new command")
          subjectPattern: ^[a-z].+$
          subjectPatternError: |
            The subject "{subject}" found in the pull request title "{title}"
            must start with a lowercase letter.
            Example: "feat: add deploy command"
          # Allow [WIP] prefix to skip validation on in-progress PRs
          wip: true
          # Validate the commit message when a PR has a single commit, since
          # GitHub suggests using it as the merge commit message on squash-merge
          validateSingleCommit: true
          validateSingleCommitMatchesPrTitle: true
          # Skip validation for bot/dependency PRs
          ignoreLabels: |
            bot
            dependencies
